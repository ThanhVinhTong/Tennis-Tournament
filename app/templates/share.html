<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Share Data</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  
  <!-- FontAwesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/visualise.css') }}">
  
  <link rel="stylesheet" href="{{ url_for('static', filename='css/share.css') }}">
  <script src="../static/js/share.js"></script>
  <style>
    body { background-color: #f5f7fa; }
    .section-card {
      background: #fff;
      border-radius: 1rem;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.1);
    }
    .player-card {
      text-align: center;
      border: 1px solid #ddd;
      border-radius: 1rem;
      padding: 1rem;
      background: #fff;
      box-shadow: 0 0.25rem 0.5rem rgba(0,0,0,0.05);
    }
    .player-card img {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      margin-bottom: 0.5rem;
    }
    .filters .form-select, .filters .form-control {
      min-width: 160px;
    }
  </style>
</head>
<body>  
  <nav class="navbar navbar-expand-lg navbar-dark mb-4"
  style="background-color: var(--tennis-green);">
<div class="container">
 <a class="navbar-brand" href="{{ url_for('main.home') }}">
   <i class="fas fa-tennis-ball me-2"></i>Tennis Tournament
 </a>
 <button class="navbar-toggler" type="button"
         data-bs-toggle="collapse" data-bs-target="#navbarNavShare">
   <span class="navbar-toggler-icon"></span>
 </button>
 <div class="collapse navbar-collapse" id="navbarNavShare">
   <ul class="navbar-nav me-auto">
     <li class="nav-item">
       <a class="nav-link {% if request.endpoint=='main.home' %}active{% endif %}"
          href="{{ url_for('main.home') }}">
         <i class="fas fa-home"></i> Home
       </a>
     </li>
     <li class="nav-item">
       <a class="nav-link {% if request.endpoint=='main.upload' %}active{% endif %}"
          href="{{ url_for('main.upload') }}">
         <i class="fas fa-upload"></i> Upload
       </a>
     </li>
     <li class="nav-item">
       <a class="nav-link {% if request.endpoint=='main.visualise' %}active{% endif %}"
          href="{{ url_for('main.visualise') }}">
         <i class="fas fa-chart-bar"></i> Analytics
       </a>
     </li>
     <li class="nav-item">
       <a class="nav-link {% if request.endpoint=='main.share' %}active{% endif %}"
          href="{{ url_for('main.share') }}">
         <i class="fas fa-share-alt"></i> Share
       </a>
     </li>
   </ul>
   <div class="d-flex">
     <span class="navbar-text me-3"><i class="fas fa-user"></i> John Doe</span>
     <button class="btn btn-outline-light btn-sm">
       <i class="fas fa-sign-out-alt"></i> Logout
     </button>
   </div>
 </div>
</div>
</nav>



<div class="container my-5">
  
  <!-- Tournament Share -->
  <div class="card mb-4">
    <div class="card-header bg-success text-white">
      <h5 class="mb-0">üéæ Tournament Share</h5>
    </div>

    <div class="form-group mt-4">
      <label class="form-label">Select Match Date</label>
      <input type="date" class="form-control" id="tournament-date">
    </div>

    <div class="mt-4" id="tournament-results">
      <label class="form-label">Select Matches to Share</label>
      <div id="tournament-list">
        <p class="text-muted">Please select a date first</p>
      </div>
    </div>

    <div class="mt-4">
      <label class="form-label">Share With Users</label>
      <select class="form-select" id="tournament-users" multiple>
        <option>User A</option>
        <option>User B</option>
        <option>User C</option>
      </select>
      <button class="btn btn-primary mt-3" id="share-tournament">Share Tournament</button>
    </div>
  </div>
</div>

<div class="container my-5">

  <!-- Player Share -->
  <div class="card mb-4">
    <div class="card-header bg-success text-white">
      <h5 class="mb-0">üë§ Player Share</h5>
    </div>

    <div class="row mb-3 filters g-2">
      <div class="col-md-4">
        <input type="text" class="form-control" id="search-player" placeholder="Search all players">
      </div>
      <div class="col-md-2">
        <select class="form-select" id="filter-type">
          <option value="">Match Type</option>
          <option value="Singles">Singles</option>
          <option value="Doubles">Doubles</option>
        </select>
      </div>
      <div class="col-md-2">
        <select class="form-select" id="filter-ranking">
          <option value="">Ranking</option>
          <option value="Top 10">Top 10</option>
          <option value="10-50">10-50</option>
          <option value="50+">50+</option>
        </select>
      </div>
      <div class="col-md-2">
        <select class="form-select" id="filter-country">
          <option value="">Country (All)</option>
          <option value="ITA">Italy</option>
          <option value="GER">Germany</option>
          <option value="ESP">Spain</option>
          <option value="USA">USA</option>
          <option value="SRB">Serbia</option>
        </select>
      </div>
      <div class="col-md-2 text-end">
        <button class="btn btn-outline-secondary w-100" id="reset-filters">Reset</button>
      </div>
    </div>

    <div class="row" id="player-grid"></div>

    <div class="mt-4">
      <label class="form-label">Share With Users</label>
      <select class="form-select" id="player-users" multiple>
        <option>User A</option>
        <option>User B</option>
        <option>User C</option>
      </select>
      <button class="btn btn-primary mt-3" id="share-player">Share Selected Players</button>
    </div>
</div>

<script>
  const mockMatches = {
    "2025-04-22": [
      { id: 1, title: "üèÜ Alice vs Bob" },
      { id: 2, title: "ü•á Charlie vs Dan" }
    ],
    "2025-04-21": [
      { id: 3, title: "üèÖ Eva vs Frank" }
    ]
  };

  const mockPlayers = [
    { name: "Jannik Sinner", country: "ITA", ranking: 1, matchType: "Singles", flag: "it" },
    { name: "Alex Zverev", country: "GER", ranking: 2, matchType: "Singles", flag: "de" },
    { name: "Carlos Alcaraz", country: "ESP", ranking: 3, matchType: "Singles", flag: "es"},
    { name: "Taylor Fritz", country: "USA", ranking: 4, matchType: "Singles", flag: "us"},
    { name: "Novak Djokovic", country: "SRB", ranking: 5, matchType: "Singles", flag: "rs"},
  ];

  function renderPlayers(players) {
    const grid = $('#player-grid').empty();
    if (players.length === 0) {
      grid.append('<p class="text-muted">No players found</p>');
      return;
    }

    players.forEach((p, index) => {
      grid.append(`
        <div class="col-md-2 mb-4">
          <div class="player-card">
            <div class="fw-bold">${p.name}</div>
            <div>
              <img src="https://flagcdn.com/w20/${p.flag}.png" alt="${p.country} flag" class="flag-icon">
              <div>${p.country}</div> <!-- Country abbreviation displayed on a new line -->
            </div>
            <div class="text-muted small">Rank #${p.ranking}</div>
            <div class="form-check mt-2">
              <input class="form-check-input select-player" type="checkbox" data-name="${p.name}">
            </div>
          </div>
        </div>
      `);
    });
  }

  function filterPlayers() {
    const keyword = $('#search-player').val().toLowerCase();
    const type = $('#filter-type').val();
    const rank = $('#filter-ranking').val();
    const country = $('#filter-country').val();

    const filtered = mockPlayers.filter(p => {
      return (
        (!keyword || p.name.toLowerCase().includes(keyword)) &&
        (!type || p.matchType === type) &&
        (!country || p.country === country) &&
        (!rank || (rank === "Top 10" && p.ranking <= 10) ||
         (rank === "10-50" && p.ranking > 10 && p.ranking <= 50) ||
         (rank === "50+" && p.ranking > 50))
      );
    });

    renderPlayers(filtered);
  }

  $(document).ready(function () {
    // Tournament logic
    $('#tournament-date').on('change', function () {
      const date = $(this).val();
      const results = mockMatches[date] || [];
      const list = $('#tournament-list').empty();

      if (results.length === 0) {
        list.append('<p class="text-muted">No matches on this date</p>');
      } else {
        results.forEach(match => {
          list.append(`
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="match_${match.id}" value="${match.title}">
              <label class="form-check-label" for="match_${match.id}">${match.title}</label>
            </div>
          `);
        });
      }
    });

    $('#share-tournament').on('click', function () {
      const selectedMatches = $('#tournament-list input:checked').map(function () { return $(this).val(); }).get();
      const users = $('#tournament-users').val();

      if (!selectedMatches.length || !users.length) {
        alert('Please select matches and users!');
        return;
      }

      alert('‚úÖ Matches shared with: ' + users.join(', ') + '\nMatches: ' + selectedMatches.join('; '));
    });

    $('#search-player, #filter-type, #filter-ranking, #filter-country').on('input change', filterPlayers);
    $('#reset-filters').on('click', function () {
      $('#search-player').val('');
      $('#filter-type').val('');
      $('#filter-ranking').val('');
      $('#filter-country').val('');
      renderPlayers(mockPlayers);
    });

    $('#share-player').on('click', function () {
      const selectedPlayers = $('.select-player:checked').map(function () {
        return $(this).data('name');
      }).get();
      const users = $('#player-users').val();

      if (!selectedPlayers.length || !users.length) {
        alert('Please select players and users!');
        return;
      }

      alert('‚úÖ Player(s) shared with: ' + users.join(', ') + '\nPlayers: ' + selectedPlayers.join(', '));
    });

    // Initial render
    renderPlayers(mockPlayers);
  });
</script>
</body>
</html>
